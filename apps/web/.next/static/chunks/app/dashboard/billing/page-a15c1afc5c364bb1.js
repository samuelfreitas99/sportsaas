(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[600],{6025:function(e,l,s){Promise.resolve().then(s.bind(s,8201))},8201:function(e,l,s){"use strict";s.r(l),s.d(l,{default:function(){return n}});var a=s(7437),t=s(2265),r=s(826);function n(){var e;let[l,s]=(0,t.useState)(null),[n,i]=(0,t.useState)(!0),[c,o]=(0,t.useState)(!1),[d,u]=(0,t.useState)(null),[m,x]=(0,t.useState)(null);(0,t.useEffect)(()=>{s(localStorage.getItem("currentOrgId"))},[]);let h=async e=>{u(null);try{let l=await r.Z.get("/orgs/".concat(e,"/billing-settings"));x(l.data)}catch(e){console.error(e),x(null),u("Falha ao carregar billing settings (verifique permiss\xf5es).")}finally{i(!1)}};(0,t.useEffect)(()=>{if(!l){i(!1);return}h(l)},[l]);let g=(0,t.useMemo)(()=>!!m&&!(m.due_day<1)&&!(m.due_day>31)&&("CUSTOM_WEEKS"!==m.cycle||!!m.cycle_weeks&&!(m.cycle_weeks<=0)),[m]),b=async()=>{if(l&&m&&g){o(!0),u(null);try{await r.Z.put("/orgs/".concat(l,"/billing-settings"),m),await h(l)}catch(e){console.error(e),u("Falha ao salvar billing settings.")}finally{o(!1)}}};return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50 p-8",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Billing"}),(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:["Org: ",(0,a.jsx)("span",{className:"font-mono",children:null!=l?l:"-"})]})]}),!l&&(0,a.jsx)("div",{className:"bg-white p-6 rounded shadow",children:(0,a.jsx)("p",{className:"text-gray-700",children:"Selecione uma organiza\xe7\xe3o no Dashboard primeiro."})}),l&&(0,a.jsxs)("div",{className:"bg-white p-6 rounded shadow max-w-2xl",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h2",{className:"text-xl font-bold",children:"Configura\xe7\xf5es"}),(0,a.jsx)("button",{className:"text-sm px-3 py-1 border rounded hover:bg-gray-50",onClick:()=>h(l),disabled:n,children:"Recarregar"})]}),d&&(0,a.jsx)("div",{className:"mb-3 text-sm text-red-600",children:d}),n?(0,a.jsx)("div",{className:"text-gray-500",children:"Carregando..."}):m?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"Billing Mode"}),(0,a.jsxs)("select",{className:"w-full border p-2 rounded",value:m.billing_mode,onChange:e=>x({...m,billing_mode:e.target.value}),children:[(0,a.jsx)("option",{value:"HYBRID",children:"HYBRID"}),(0,a.jsx)("option",{value:"MEMBERSHIP",children:"MEMBERSHIP"}),(0,a.jsx)("option",{value:"PER_SESSION",children:"PER_SESSION"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"Cycle"}),(0,a.jsxs)("select",{className:"w-full border p-2 rounded",value:m.cycle,onChange:e=>x({...m,cycle:e.target.value}),children:[(0,a.jsx)("option",{value:"MONTHLY",children:"MONTHLY"}),(0,a.jsx)("option",{value:"WEEKLY",children:"WEEKLY"}),(0,a.jsx)("option",{value:"CUSTOM_WEEKS",children:"CUSTOM_WEEKS"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"Anchor Date"}),(0,a.jsx)("input",{className:"w-full border p-2 rounded",type:"date",value:m.anchor_date,onChange:e=>x({...m,anchor_date:e.target.value})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"Due Day"}),(0,a.jsx)("input",{className:"w-full border p-2 rounded",type:"number",value:m.due_day,onChange:e=>x({...m,due_day:parseInt(e.target.value||"0")})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"Cycle Weeks"}),(0,a.jsx)("input",{className:"w-full border p-2 rounded",type:"number",value:null!==(e=m.cycle_weeks)&&void 0!==e?e:"",onChange:e=>x({...m,cycle_weeks:""===e.target.value?null:parseInt(e.target.value)}),placeholder:"Somente para CUSTOM_WEEKS"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"Membership Amount"}),(0,a.jsx)("input",{className:"w-full border p-2 rounded",type:"number",step:"0.01",value:m.membership_amount,onChange:e=>x({...m,membership_amount:parseFloat(e.target.value||"0")})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"Session Amount"}),(0,a.jsx)("input",{className:"w-full border p-2 rounded",type:"number",step:"0.01",value:m.session_amount,onChange:e=>x({...m,session_amount:parseFloat(e.target.value||"0")})})]})]}),(0,a.jsx)("button",{className:"w-full bg-blue-600 text-white px-4 py-2 rounded disabled:opacity-60",onClick:b,disabled:!g||c,children:"Salvar"})]}):(0,a.jsx)("div",{className:"text-gray-500",children:"Sem dados."})]})]})}},826:function(e,l,s){"use strict";var a,t=s(4829),r=s(2601);let n=t.Z.create({baseURL:null!==(a=r.env.NEXT_PUBLIC_API_URL)&&void 0!==a?a:"http://localhost:8000/api/v1"});n.interceptors.request.use(e=>{{let l=localStorage.getItem("token");l&&(e.headers.Authorization="Bearer ".concat(l))}return e}),n.interceptors.response.use(e=>e,e=>{var l;return 401===(null==e?void 0:null===(l=e.response)||void 0===l?void 0:l.status)&&(localStorage.removeItem("token"),localStorage.removeItem("currentOrgId"),window.location.href="/login"),Promise.reject(e)}),l.Z=n}},function(e){e.O(0,[737,971,938,744],function(){return e(e.s=6025)}),_N_E=e.O()}]);