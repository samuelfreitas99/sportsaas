(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[27],{2366:function(e,a,s){Promise.resolve().then(s.bind(s,4871))},4871:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return n}});var r=s(7437),t=s(2265),l=s(826);function n(){let[e,a]=(0,t.useState)(null),[s,n]=(0,t.useState)([]),[c,o]=(0,t.useState)(!0),[i,d]=(0,t.useState)(null),[m,u]=(0,t.useState)(""),[h,x]=(0,t.useState)("MEMBER"),[b,g]=(0,t.useState)(!1);(0,t.useEffect)(()=>{a(localStorage.getItem("currentOrgId"))},[]);let p=async e=>{d(null);try{let a=await l.Z.get("/orgs/".concat(e,"/members"));n(a.data)}catch(e){console.error(e),n([]),d("Falha ao carregar membros")}finally{o(!1)}};(0,t.useEffect)(()=>{if(!e){o(!1);return}p(e)},[e]);let v=(0,t.useMemo)(()=>m.trim().length>3,[m]),N=async()=>{if(e&&v){g(!0),d(null);try{await l.Z.post("/orgs/".concat(e,"/members"),{email:m.trim(),role:h}),u(""),x("MEMBER"),await p(e)}catch(e){console.error(e),d("Falha ao adicionar membro")}finally{g(!1)}}},j=async(a,s)=>{if(e){d(null);try{await l.Z.patch("/orgs/".concat(e,"/members/").concat(a,"/role"),{role:s}),await p(e)}catch(e){console.error(e),d("Falha ao alterar role")}}},y=async(a,s)=>{if(e){d(null);try{await l.Z.patch("/orgs/".concat(e,"/members/").concat(a),{member_type:s}),await p(e)}catch(e){console.error(e),d("Falha ao alterar member_type")}}},f=async a=>{if(e){d(null);try{await l.Z.delete("/orgs/".concat(e,"/members/").concat(a)),await p(e)}catch(e){console.error(e),d("Falha ao remover membro")}}};return(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50 p-8",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold",children:"Membros"}),(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:["Org: ",(0,r.jsx)("span",{className:"font-mono",children:null!=e?e:"-"})]})]}),!e&&(0,r.jsx)("div",{className:"bg-white p-6 rounded shadow",children:(0,r.jsx)("p",{className:"text-gray-700",children:"Selecione uma organiza\xe7\xe3o no Dashboard primeiro."})}),e&&(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,r.jsxs)("div",{className:"lg:col-span-2 bg-white p-6 rounded shadow",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsx)("h2",{className:"text-xl font-bold",children:"Lista"}),(0,r.jsx)("button",{onClick:()=>p(e),className:"text-sm px-3 py-1 border rounded hover:bg-gray-50",disabled:c,children:"Recarregar"})]}),i&&(0,r.jsx)("div",{className:"mb-3 text-sm text-red-600",children:i}),c?(0,r.jsx)("div",{className:"text-gray-500",children:"Carregando..."}):(0,r.jsxs)("div",{className:"space-y-2",children:[s.map(e=>(0,r.jsxs)("div",{className:"border rounded p-3 flex items-center justify-between gap-3",children:[(0,r.jsxs)("div",{className:"min-w-0",children:[(0,r.jsx)("div",{className:"font-semibold truncate",children:e.nickname||e.user.full_name||e.user.email}),(0,r.jsx)("div",{className:"text-sm text-gray-500 truncate",children:e.user.email}),(0,r.jsxs)("div",{className:"mt-1 flex gap-2",children:[(0,r.jsx)("span",{className:"text-xs px-2 py-0.5 rounded border ".concat("MONTHLY"===e.member_type?"bg-blue-50 text-blue-700 border-blue-200":"bg-yellow-50 text-yellow-800 border-yellow-200"),children:e.member_type}),!e.is_active&&(0,r.jsx)("span",{className:"text-xs px-2 py-0.5 rounded border bg-gray-100 text-gray-700 border-gray-200",children:"INACTIVE"})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("select",{className:"border p-2 rounded text-sm",value:e.member_type,onChange:a=>y(e.id,a.target.value),children:[(0,r.jsx)("option",{value:"MONTHLY",children:"MONTHLY"}),(0,r.jsx)("option",{value:"GUEST",children:"GUEST"})]}),(0,r.jsxs)("select",{className:"border p-2 rounded text-sm",value:e.role,onChange:a=>j(e.id,a.target.value),children:[(0,r.jsx)("option",{value:"OWNER",children:"OWNER"}),(0,r.jsx)("option",{value:"ADMIN",children:"ADMIN"}),(0,r.jsx)("option",{value:"MEMBER",children:"MEMBER"})]}),(0,r.jsx)("button",{onClick:()=>f(e.id),className:"text-sm px-3 py-2 rounded bg-red-600 text-white hover:bg-red-700",children:"Remover"})]})]},e.id)),0===s.length&&(0,r.jsx)("div",{className:"text-gray-500",children:"Nenhum membro encontrado."})]})]}),(0,r.jsxs)("div",{className:"bg-white p-6 rounded shadow",children:[(0,r.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Adicionar"}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"Email"}),(0,r.jsx)("input",{className:"w-full border p-2 rounded",value:m,onChange:e=>u(e.target.value),placeholder:"email@exemplo.com",type:"email"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"Role"}),(0,r.jsxs)("select",{className:"w-full border p-2 rounded",value:h,onChange:e=>x(e.target.value),children:[(0,r.jsx)("option",{value:"MEMBER",children:"MEMBER"}),(0,r.jsx)("option",{value:"ADMIN",children:"ADMIN"}),(0,r.jsx)("option",{value:"OWNER",children:"OWNER"})]})]}),(0,r.jsx)("button",{onClick:N,disabled:!v||b,className:"w-full bg-blue-600 text-white px-4 py-2 rounded disabled:opacity-60",children:"Adicionar membro"})]})]})]})]})}},826:function(e,a,s){"use strict";var r,t=s(4829),l=s(2601);let n=t.Z.create({baseURL:null!==(r=l.env.NEXT_PUBLIC_API_URL)&&void 0!==r?r:"http://localhost:8000/api/v1"});n.interceptors.request.use(e=>{{let a=localStorage.getItem("token");a&&(e.headers.Authorization="Bearer ".concat(a))}return e}),n.interceptors.response.use(e=>e,e=>{var a;return 401===(null==e?void 0:null===(a=e.response)||void 0===a?void 0:a.status)&&(localStorage.removeItem("token"),localStorage.removeItem("currentOrgId"),window.location.href="/login"),Promise.reject(e)}),a.Z=n}},function(e){e.O(0,[737,971,938,744],function(){return e(e.s=2366)}),_N_E=e.O()}]);